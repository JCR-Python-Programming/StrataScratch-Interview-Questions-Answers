### **Bold** You're given a dataset of searches for properties on Airbnb. For simplicity, let's say that each search result (i.e., each row) represents a unique host. 
Find the city with the most amenities across all their host's properties. Output the name of the city.

SQL: 
-----------------------------------------
WITH unnest AS(
SELECT city, 
       UNNEST(STRING_TO_ARRAY(amenities, ',')) AS amenities
    FROM airbnb_search_details), 
    
rankings AS (
SELECT city, 
       COUNT(amenities) AS total_amenities,
       ROW_NUMBER() OVER (ORDER BY COUNT(amenities) DESC) AS amenity_ranking
    FROM unnest
GROUP BY city) 

SELECT city
    FROM rankings 
WHERE amenity_ranking = 1   

Python: 
-----------------------------------------

df = airbnb_search_details 

df['total_amenities'] = df['amenities'].apply(lambda x: len(x.strip(',')))

result = df.groupby('city')['total_amenities'].sum().reset_index()

result = result.sort_values('total_amenities', ascending=False).reset_index()

result = result['city'][0]
